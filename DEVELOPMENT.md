
# å°å±¿å’Œ - å¼€å‘æ–‡æ¡£

## 1. é¡¹ç›®æ¦‚è¿°

å°å±¿å’Œæ˜¯ä¸€ä¸ªæ™ºèƒ½ç–—æ„ˆä¼´ä¾£åº”ç”¨ï¼Œä¸ºæ¸´æœ›ç‰‡åˆ»å–˜æ¯çš„éƒ½å¸‚å²›æ°‘æä¾›ç²¾ç¥è‡ªç•™åœ°ã€‚

**å“ç‰Œ Slogan**: å’Œè‡ªå·±ï¼Œå¥½å¥½åœ¨ä¸€èµ·

**å½“å‰ç‰ˆæœ¬**: v2.4.0 (Analytics & Tracking)

**å“ç‰Œå‘½åè§„èŒƒ**: è¯¦è§ [brand_naming_specification.md](../../docs/brand_naming_specification.md)

---

## 2. çº¿é¦™äº§å“è§„æ ¼

### 2.1 SKU æ¦‚è§ˆ

é¦–å‘ 3 æ¬¾çº¿é¦™ï¼Œé‡‡ç”¨"å¿ƒç†åæ ‡"å‘½åæ³•ï¼š

| æ­£å¼åç§° | å†…éƒ¨ä»£å· | å¿ƒç†åæ ‡ | Slogan å»¶å±• |
| :--- | :--- | :--- | :--- |
| **å¬è·** | è²è•Š | æ¾„æ¾ˆï¼šç‹¬å¤„çš„é™è°§æ—¶åˆ» | å’Œæ¸…é™åœ¨ä¸€èµ· |
| **æ™šå··** | æœ¨æ¨¨ | å®‰æŠšï¼šå¸ä¸‹é˜²å¤‡çš„æ¸©æš–å½’é€” | å’Œæ¸©æŸ”åœ¨ä¸€èµ· |
| **å°é™¢** | ç»¿è–„è· | å‘¼å¸ï¼šéƒ½å¸‚ä¸­çš„è‡ªç„¶é‡è¶£ | å’Œè‡ªåœ¨åœ¨ä¸€èµ· |

### 2.2 é¦™å‹ä¸éŸ³é¢‘æ˜ å°„

| é¦™å‹ | Layer 1 åœºæ™¯éŸ³ | è§†è§‰è‰²è°ƒ |
| :--- | :--- | :--- |
| **å¬è·** | æ°´æ»´å£° + æ™¨é—´é¸Ÿé¸£ | ğŸª· è²ç²‰ |
| **æ™šå··** | ç§‹é›¨å£° + æ™šé£ | ğŸŸ¡ æ¡‚é‡‘ |
| **å°é™¢** | æ£®æ—ç¯å¢ƒéŸ³ + è‰å¶æ²™æ²™ | ğŸŸ¢ è‹”ç»¿ |

---

## 3. æ ¸å¿ƒä½“éªŒæµç¨‹

### 3.0 ä»ªè¡¨ç›˜ (Dashboard) - å…¥å£
*   **åŠŸèƒ½**: å±•ç¤ºé¦™å‹å¡ç‰‡ï¼ˆå¬è·ã€æ™šå··ã€å°é™¢ï¼‰
*   **äº¤äº’**: ç‚¹å‡»å¡ç‰‡ç›´æ¥è¿›å…¥æ²‰æµ¸é¡µ
*   **è§†è§‰**: å¤šå·´èƒºé…è‰²å¡ç‰‡ + å“ç‰Œç”Ÿæ´»ç†å¿µ

### 3.1 ä»ªå¼é¡µ (Ritual) - å¯é€‰å…¥å£
*   **è§†è§‰é£æ ¼**: æ²‰æµ¸å¼æš—è‰²è°ƒ (`#121212`)
*   **äº¤äº’**: ä¸Šåˆ’å±å¹•ï¼Œæ¨¡æ‹Ÿ"ç‚¹ä¸€æ”¯é¦™"
*   **çƒŸé›¾å¼•æ“**: Canvas ç²’å­ç³»ç»Ÿ

### 3.2 æ²‰æµ¸é¡µ (Immersion)
*   **åŒå±‚éŸ³é¢‘ç³»ç»Ÿ**:
    *   **Layer 1 (åœºæ™¯éŸ³)**: åŸºç¡€ç™½å™ªéŸ³èƒŒæ™¯ (`currentAudioUrl`)
    *   **Layer 2 (åŠŸèƒ½åº•å™ª)**: å¯å åŠ çš„åŠŸèƒ½å™ªéŸ³ (`layer2AudioUrl`)
        | æ¨¡å¼ | ID | éŸ³é¢‘ç±»å‹ |
        |------|-----|---------|
        | ğŸƒ æœ¬å‘³ | `original` | æ— å åŠ  |
        | ğŸŒ™ å…¥çœ  | `sleep` | ç²‰çº¢å™ªéŸ³ |
        | ğŸ’¨ å†¥æƒ³ | `meditate` | æ£•è‰²å™ªéŸ³ |
*   **åŠ¨æ€è¯—æ­Œ**: æ ¹æ®æ‰€é€‰é¦™å‹æ˜¾ç¤ºå¯¹åº”åœºæ™¯æè¿°è¯—æ­Œ
    | é¦™å‹ | è¯—æ­Œç‰‡æ®µ |
    |------|----------|
    | **å¬è·** | è·å¡˜æ— å£° / æ™¨éœ²åœ¨ç¢§ç»¿çš„è·å¶é—´ / è½»è½»æ»šåŠ¨ / æ­¤é—´ç‹¬å / å¬è·å£° / è§æ¸…é™ |
    | **æ™šå··** | è€å··æ·±å¤„ / ç§‹é›¨è¿‡åï¼Œå¤•é˜³åœ¨é’çŸ³æ¿ä¸Š / æŸ“äº†ä¸€å±‚é‡‘ / æ­¤é—´é©»è¶³ / å¯»é¦™å» / è§æ¸©æŸ” |
    | **å°é™¢** | å±±é—´å°é™¢ / è‹”è—“åœ¨çŸ³é˜¶ä¸Š / é™é™ç”Ÿé•¿ / æ­¤é—´èººå§ / å¬é£è¿‡ / è§è‡ªåœ¨ |
*   **è®¡æ—¶**: 10 åˆ†é’Ÿ (`IMMERSION_DURATION = 600,000ms`)

### 3.3 æ ‘æ´é¡µ (Treehole)
*   **ç®€åŒ–æµç¨‹**:
    1. å¿ƒæƒ…é€‰æ‹© (æœ‰ç‚¹ç„¦è™‘ã€æœ‰ç‚¹ç´¯ã€æœ‰ç‚¹ä¹±ã€æœ‰ç‚¹éš¾è¿‡ã€æƒ³é™é™ã€å°ç¡®å¹¸)
    2. åœºæ™¯è¯†åˆ« (å·¥ä½œ/å­¦ä¸šã€æ„Ÿæƒ…ã€å¥åº·/èº«æã€å®¶åº­ã€äººé™…å…³ç³»ã€è¯´ä¸æ¸…)
    3. å°å±¿çš„å›ä¿¡ (AI ç”Ÿæˆ)
    4. åŒé¢‘å›å“ (åŒ¿åé‚»å±…åˆ†äº«)

---

## 4. å“ç‰Œç”¨è¯è§„èŒƒ

### 4.1 Do (æå€¡)

| æ¨èç”¨è¯ | åœºæ™¯ |
| :--- | :--- |
| **å²›æ°‘** | ç§°å‘¼ç”¨æˆ· |
| **é‚»å±…** | App å†…å…¶ä»–ç”¨æˆ· |
| **å¸¦èµ° / è¯·å›** | è´­ä¹°è¡Œä¸º |
| **ç‚¹ä¸€æ”¯** | ä½¿ç”¨çº¿é¦™ |
| **å™¨ç‰©** | äº§å“ç»Ÿç§° |

### 4.2 Don't (ç¦æ­¢)

| ç¦æ­¢ç”¨è¯ | æ›¿ä»£å»ºè®® |
| :--- | :--- |
| å®¢æˆ· | å²›æ°‘ |
| ä¸‹å• / è´­ä¹° | å¸¦èµ° / è¯·å› |
| ç‡ƒçƒ§ | ç‚¹ç‡ƒ / ç‚¹ä¸€æ”¯ |
| å¥¢ä¾ˆ / é¡¶çº§ / æè‡´ | ç”¨äº§å“æ•…äº‹æ›¿ä»£ |

---

## 5. æŠ€æœ¯æ¶æ„

### 5.1 ç»„ä»¶ç»“æ„
```
App.tsx
â”œâ”€â”€ Phase çŠ¶æ€ç®¡ç† (AppPhase enum)
â”œâ”€â”€ AudioPlayer (Layer 1)
â”œâ”€â”€ AudioPlayer (Layer 2)
â”œâ”€â”€ DynamicBackground
â”œâ”€â”€ Ritual (æ¡ä»¶æ¸²æŸ“)
â”œâ”€â”€ Immersion (å†…è”æ¸²æŸ“)
â”œâ”€â”€ Treehole (å†…è”æ¸²æŸ“)
â””â”€â”€ Dashboard
```

### 5.2 æ ¸å¿ƒçŠ¶æ€

| çŠ¶æ€ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `phase` | `AppPhase` | å½“å‰é¡µé¢é˜¶æ®µ |
| `currentAudioUrl` | `string` | Layer 1 éŸ³é¢‘ URL |
| `layer2AudioUrl` | `string` | Layer 2 éŸ³é¢‘ URL |
| `activeAmbianceId` | `string` | å½“å‰æ°›å›´æ¨¡å¼ ID |
| `aiResult` | `TreeholeResult` | AI å›å¤ç»“æœ |

---

## 6. æ•°æ®åŸ‹ç‚¹ç³»ç»Ÿ

### 6.1 æ¶æ„æ¦‚è§ˆ

```
lib/analytics/
â”œâ”€â”€ types.ts              # ç±»å‹å®šä¹‰å’Œäº‹ä»¶æ¥å£
â”œâ”€â”€ analyticsService.ts   # æ ¸å¿ƒåˆ†ææœåŠ¡
â”œâ”€â”€ entryDetection.ts     # NFC å…¥å£æ£€æµ‹å·¥å…·
â”œâ”€â”€ userService.ts        # åŒ¿åç”¨æˆ·ç®¡ç†
â”œâ”€â”€ supabaseClient.ts     # Supabase å®¢æˆ·ç«¯
â””â”€â”€ index.ts              # å…¬å…± API å¯¼å‡º
```

### 6.2 æ•°æ®åº“è¡¨ç»“æ„

| è¡¨å | ç”¨é€” | å…³é”®å­—æ®µ |
|------|------|---------|
| `users` | åŒ¿åç”¨æˆ· | `device_id`, `is_anonymous` |
| `sessions` | ç–—æ„ˆä¼šè¯ | `entry_type`, `fragrance_id`, `duration_seconds` |
| `mood_records` | å¿ƒæƒ…è®°å½• | `mood_after`, `context`, `self_evaluation` |
| `social_interactions` | ç¤¾äº¤äº’åŠ¨ | `interaction_type` (give_hug, etc.) |
| `analytics_events` | äº‹ä»¶åŸ‹ç‚¹ | `event_type`, `event_data` (JSONB) |

### 6.3 äº‹ä»¶ç±»å‹

| äº‹ä»¶ | è§¦å‘æ—¶æœº | æ•°æ®å­—æ®µ |
|------|---------|---------|
| `fragrance_confirm` | é¦™å‹ç¡®è®¤ç‚¹å‡» | `fragranceId`, `entryType`, `wasSwitched` |
| `fragrance_switch` | é¦™å‹åˆ‡æ¢ | `fromFragranceId`, `toFragranceId` |
| `ritual_complete` | ä»ªå¼å®Œæˆ | `fragranceId` |
| `ambiance_change` | æ°›å›´æ¨¡å¼åˆ‡æ¢ | `fromMode`, `toMode` |
| `mood_select` | å¿ƒæƒ…é€‰æ‹© | `mood` |
| `context_select` | åœºæ™¯é€‰æ‹© | `context`, `mood` |
| `give_hug` | ç»™äºˆæ‹¥æŠ± | `targetEchoId` |

### 6.4 NFC å…¥å£æ£€æµ‹

**æ¶æ„**:
```
NFC èŠ¯ç‰‡ â†’ /api/nfc â†’ Netlify Function â†’ é‡å®šå‘ï¼ˆå¸¦æ—¶é—´æˆ³ï¼‰
```

**URL æ ¼å¼**:
- NFC å†™å…¥: `https://xiaoyuandincense.netlify.app/api/nfc`
- é‡å®šå‘å: `https://xiaoyuandincense.netlify.app/?nfc=1&t=1707900000`

**æ£€æµ‹é€»è¾‘**:
- `nfc=1`: æ ‡è¯†æ¥è‡ª NFC æ‰«æ
- `t`: æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰ï¼Œç”± Netlify Function åŠ¨æ€ç”Ÿæˆ
- åªæœ‰ 5 åˆ†é’Ÿå†…çš„è®¿é—®æ‰è¢«è¯†åˆ«ä¸º NFC å…¥å£
- è¿‡æœŸé“¾æ¥/ä¹¦ç­¾è‡ªåŠ¨è¯†åˆ«ä¸º Dashboard å…¥å£

**Netlify Function** (`netlify/functions/nfc.ts`):
```typescript
// NFC æ‰«æ â†’ ç”Ÿæˆæ—¶é—´æˆ³ â†’ é‡å®šå‘
export const handler = async (event) => {
  const timestamp = Date.now();
  return {
    statusCode: 302,
    headers: { 'Location': `/?nfc=1&t=${timestamp}` }
  };
};
```

**ä½¿ç”¨æ–¹å¼**:
```typescript
import { detectEntryType } from './lib/analytics';

// æ£€æµ‹å…¥å£ç±»å‹
const result = detectEntryType();
// { type: 'nfc', isFromNFC: true }
```

### 6.5 éªŒè¯æŒ‡æ ‡å¯¹ç…§

| PRD æŒ‡æ ‡ | æ•°æ®åº“æ”¯æŒ | æŸ¥è¯¢æ–¹å¼ |
|---------|-----------|---------|
| NFC æ¿€æ´»ç‡ | âœ… | `sessions WHERE entry_type='nfc'` |
| Session Duration | âœ… | `sessions.duration_seconds` |
| One-Tap Success | âœ… | `analytics_events` â†’ `wasSwitched=false` |
| Mood Shift | âš ï¸ éƒ¨åˆ† | `mood_records.mood_after` (ç¼ºä¼šå‰å¿ƒæƒ…) |
| Echo Interaction | âœ… | `social_interactions WHERE type='give_hug'` |

---

## 7. èµ„æºé…ç½®

| èµ„æºç±»å‹ | ç”¨é€” | æ¥æº |
| :--- | :--- | :--- |
| èƒŒæ™¯å›¾ç‰‡ | ä¸»èƒŒæ™¯ | è…¾è®¯äº‘ COS |
| éŸ³é¢‘ (Layer 1) | åœºæ™¯ç™½å™ªéŸ³ | è…¾è®¯äº‘ COS |
| éŸ³é¢‘ (Layer 2) | ç²‰å™ª/æ£•å™ª | æœ¬åœ° `/Audio` ç›®å½• |
| è½¬åœºéŸ³æ•ˆ | é¡µé¢åˆ‡æ¢ | Pixabay CDN |

---

## 8. ç‰ˆæœ¬å†å²

### v2.4.0 (Analytics & Tracking) - Current
*   [Feature] **æ•°æ®åŸ‹ç‚¹ç³»ç»Ÿ**:
    - åŸºäº Supabase çš„åŒ¿åç”¨æˆ·è¿½è¸ª
    - å®Œæ•´äº‹ä»¶ç±»å‹å®šä¹‰ (`types.ts`)
    - åˆ†ææœåŠ¡å°è£… (`analyticsService.ts`)
*   [Feature] **NFC å…¥å£æ£€æµ‹** (`entryDetection.ts`):
    - Netlify Functions åŠ¨æ€æ—¶é—´æˆ³ç”Ÿæˆ
    - æ—¶é—´çª—å£éªŒè¯ (5 åˆ†é’Ÿ)
    - URL å‚æ•°æ¸…ç†
*   [Feature] **å…³é”®åŸ‹ç‚¹**:
    - `fragrance_confirm`: é¦™å‹ç¡®è®¤ï¼ˆæ¼æ–—å…³é”®èŠ‚ç‚¹ï¼‰
    - `entryType`: åŒºåˆ† NFC/Dashboard å…¥å£
    - `wasSwitched`: One-Tap Success æŒ‡æ ‡
*   [Infra] **Netlify Functions**: NFC åŠ¨æ€é‡å®šå‘ (`netlify/functions/nfc.ts`)
*   [Config] **Supabase RLS ç­–ç•¥**: åŒ¿åç”¨æˆ· INSERT/UPDATE/SELECT æƒé™
*   [Docs] **PRD æŒ‡æ ‡æ ¸å¯¹**: éªŒè¯æ•°æ®åº“é…ç½®ä¸ PRD å…³é”®æŒ‡æ ‡åŒ¹é…åº¦

### v2.3.0 (Immersion Experience)
*   [UI] **å¤§åœ°è‰²è°ƒç³»ç»Ÿ**:
    - å…¨å±€èƒŒæ™¯: `#f7f5f2` (ç¦…æ„èƒŒæ™¯)
    - å¤§åœ°è‰²ç³»: taupe (`#8d7d77`), sage (`#949b8a`), sand (`#f2ede4`), clay (`#bfa594`)
    - çº¿é¦™ä¸“å±è‰² (ä½é¥±å’Œåº¦ï¼Œä¿æŒåŒºåˆ†åº¦):
      - å¬è·: lotus-pink (`#e8ccc8`) / lotus-pink-dark (`#c4908a`) - è²ç²‰
      - æ™šå··: osmanthus-gold (`#e8dcc0`) / osmanthus-gold-dark (`#c4a060`) - æ¡‚é‡‘
      - å°é™¢: moss-green (`#d4ddd4`) / moss-green-dark (`#9aab9a`) - è‹”ç»¿
*   [UI] **Dashboard å¡ç‰‡å±•å¼€é‡æ„**:
    - ç§»é™¤åº•éƒ¨æµ®åŠ¨æŒ‰é’®åŒºåŸŸ
    - å°†"ç‚¹ä¸€æ”¯"å’Œ"æŸ¥çœ‹é¦™æ–¹"æŒ‰é’®æ•´åˆåˆ°å±•å¼€çš„å¡ç‰‡å†…
    - å±•å¼€å¡ç‰‡æ˜¾ç¤ºï¼šé¦™ææ ‡ç­¾ + é¦™å‹åç§° + æ•…äº‹æè¿° + æ“ä½œæŒ‰é’®
*   [UI] **"ç‚¹ä¸€æ”¯"æŒ‰é’®æ ·å¼å‡çº§**:
    - å›¾æ ‡: `Flame` (ç«ç„°å›¾æ ‡ï¼Œç¬¦åˆç‡ƒé¦™æ„å¢ƒ)
    - èƒŒæ™¯: `#3a3530` (æ·±æ£•é»‘è‰²)
    - æ–‡å­—: `#f2ede4` (ç±³ç™½è‰²/æ²™è‰²)
    - å­—ä½“: è¡¬çº¿æ–œä½“ (`font-serif italic`)
*   [UI] **é¦™æ–¹è¯¦æƒ…å¼¹çª—é‡è®¾è®¡**:
    - ç»Ÿä¸€ä½¿ç”¨é¦™å‹ä¸»é¢˜è‰²è°ƒ
    - å†…å®¹é¡ºåºï¼šå…ˆ"åˆ¶é¦™å¸ˆè¯´"ï¼Œå"å®‰å¿ƒè¯´æ˜"
    - ç§»é™¤é‡å¤çš„é¦™æ–¹è¯¦æƒ…åˆ—è¡¨
*   [Feature] **æ²‰æµ¸é¡µé™æ€æ¸å˜èƒŒæ™¯**:
    - ä¸‰å±‚å¾„å‘æ¸å˜å åŠ ï¼Œè¥é€ æ·±åº¦æ„Ÿ
    - å¬è·: è²ç²‰æ¸å˜ (`primary: rgba(196,144,138,0.7)`, `secondary: rgba(232,204,200,0.6)`)
    - æ™šå··: æ¡‚é‡‘æ¸å˜ (`primary: rgba(196,160,96,0.7)`, `secondary: rgba(232,220,192,0.6)`)
    - å°é™¢: è‹”ç»¿æ¸å˜ (`primary: rgba(154,171,154,0.65)`, `secondary: rgba(212,221,212,0.6)`)
*   [Feature] **æ–‡æ¡ˆå‘¼å¸åŠ¨ç”»**:
    - åŠ¨ç”»åç§°: `textBreathe`
    - å‘¨æœŸ: 4ç§’ (`ease-in-out infinite`)
    - æ•ˆæœ: é€æ˜åº¦ 0.7 â†’ 1.0ï¼Œä½ç§» Y: 0 â†’ -3px
    - é”™å¼€å»¶è¿Ÿ: æ¯è¡Œ 0.8s
*   [Feature] **éŸ³é¢‘æ…¢é€Ÿæ·¡å…¥**:
    - ä» Dashboard è¿›å…¥æ²‰æµ¸é¡µæ—¶ç”Ÿæ•ˆ
    - æ—¶é•¿: 8ç§’
    - ç›®æ ‡éŸ³é‡: 90%
    - å®ç°æ–¹å¼: 160 æ­¥ Ã— 50ms/æ­¥
*   [Test] **æµ‹è¯•è¦†ç›–**:
    - æ–°å¢ Dashboard.test.tsx
    - TDD å¼€å‘æµç¨‹
*   [Refactor] **ç»„ä»¶æ›´æ–°**:
    - `App.tsx`: æ·»åŠ  `scentId` ä¼ é€’ç»™ `DynamicBackground`ï¼Œæ›´æ–°éŸ³é¢‘æ·¡å…¥é€»è¾‘
    - `Dashboard.tsx`: å±•å¼€å¡ç‰‡ UI é‡æ„ï¼ŒæŒ‰é’®æ ·å¼æ›´æ–°ï¼Œå¤§åœ°è‰²è°ƒé€‚é…
    - `DynamicBackground.tsx`: æ–°å¢ `scentId` propï¼Œé¦™å‹ç‰¹å®šæ¸å˜è‰²ï¼Œç§»é™¤åŠ¨ç”»
    - `constants.ts`: æ›´æ–° FRAGRANCE_LISTã€DASHBOARD_DATA é…è‰²
    - `index.html`: æ·»åŠ å¤§åœ°è‰²è°ƒå˜é‡ï¼Œæ›´æ–° `textBreathe` åŠ¨ç”»

### v2.2.0 (Brand Aligned)
*   [Brand] **å“ç‰Œå‘½åè§„èŒƒ**: é‡‡ç”¨"å¿ƒç†åæ ‡"å‘½åæ³•
*   [Brand] **çº¿é¦™é‡å‘½å**: å¬è·ã€æ™šå··ã€å°é™¢ (åŸï¼šç™½èŒ¶ã€æœ¨æ¨¨ã€è”·è–‡)
*   [Brand] **Slogan æ›´æ–°**: "å’Œè‡ªå·±ï¼Œå¥½å¥½åœ¨ä¸€èµ·"
*   [Brand] **ç”¨è¯è§„èŒƒ**: ä½¿ç”¨"å²›æ°‘"ã€"ç‚¹ä¸€æ”¯é¦™"ã€"å¸¦èµ°"ç­‰å“ç‰Œè¯æ±‡
*   [Brand] **å¿ƒæƒ…é€‰é¡¹ä¼˜åŒ–**: æœ‰ç‚¹ç´¯ã€æœ‰ç‚¹ä¹±ã€æœ‰ç‚¹éš¾è¿‡ã€æƒ³é™é™
*   [Feature] **æ²‰æµ¸é¡µåŠ¨æ€è¯—æ­Œ**: æ¯æ¬¾é¦™å‹æ‹¥æœ‰ç‹¬ç‰¹çš„åœºæ™¯æè¿°è¯—æ­Œ
    - å¬è·: "è·å¡˜æ— å£° / æ™¨éœ²åœ¨ç¢§ç»¿çš„è·å¶é—´ / è½»è½»æ»šåŠ¨..."
    - æ™šå··: "è€å··æ·±å¤„ / ç§‹é›¨è¿‡åï¼Œå¤•é˜³åœ¨é’çŸ³æ¿ä¸Š / æŸ“äº†ä¸€å±‚é‡‘..."
    - å°é™¢: "å±±é—´å°é™¢ / è‹”è—“åœ¨çŸ³é˜¶ä¸Š / é™é™ç”Ÿé•¿..."
*   [Refactor] **ä»£ç æ›´æ–°**: App.tsx æ–°å¢ `getImmersionPoem()` åŠ¨æ€è¯—æ­Œé€‰æ‹©å‡½æ•°
*   [Refactor] **å¸¸é‡æ›´æ–°**: constants.ts æ›´æ–° FRAGRANCE_LISTã€TEXT_CONTENT ç­‰é…ç½®

### v2.1.0 (Dual Layer Audio)
*   [Feature] åŒå±‚éŸ³é¢‘ç³»ç»Ÿ
*   [Feature] ä¸‰ç§æ°›å›´æ¨¡å¼
*   [Refactor] æ ‘æ´æµç¨‹ç®€åŒ–

### v1.2.2 (Visual Polish)
*   æ²‰æµ¸å¼æš—é»‘æ¨¡å¼
*   çƒŸé›¾ç²’å­ç®—æ³•å‡çº§
*   æ— ç¼è½¬åœºé€»è¾‘

---

## 9. å¾…åŠäº‹é¡¹

### ä¼˜å…ˆçº§é«˜
- [ ] **ä»£ç é‡æ„**: å°† App.tsx æ‹†åˆ†ä¸ºè‡ªå®šä¹‰ Hooks å’Œå­ç»„ä»¶
- [ ] **ç±»å‹å®Œå–„**: ç§»é™¤ `@ts-ignore` æ³¨é‡Š
- [ ] **é”™è¯¯å¤„ç†**: æ·»åŠ éŸ³é¢‘åŠ è½½å¤±è´¥çš„å‹å¥½æç¤º

### ä¼˜å…ˆçº§ä¸­
- [ ] æ·»åŠ å¤šè¯­ç§è¯—æ­Œæ”¯æŒ
- [ ] ä¼˜åŒ–ä¸åŒå±å¹•æ¯”ä¾‹çš„èƒŒæ™¯å›¾é€‚é…
- [ ] å®Œå–„å“ç‰Œç”Ÿæ´»æ–¹å¼é¡µé¢
- [ ] æ·»åŠ æœ¬åœ°éŸ³é¢‘æ–‡ä»¶çš„ CDN æ”¯æŒ
- [ ] æ·»åŠ  `mood_before` å­—æ®µæ”¯æŒ Mood Shift æŒ‡æ ‡
- [ ] æ·»åŠ è´­ä¹°æ•°æ®è¡¨æ”¯æŒå¤è´­ç‡è¿½è¸ª

### ä¼˜å…ˆçº§ä½
- [ ] PWA æ”¯æŒï¼ˆç¦»çº¿ä½¿ç”¨ï¼‰
- [ ] ç”¨æˆ·æ•°æ®æŒä¹…åŒ–

---

## 10. å¼€å‘æŒ‡å—

### æœ¬åœ°å¼€å‘
```bash
npm install
npm run dev
```

### ç¯å¢ƒå˜é‡
åˆ›å»º `.env.local` æ–‡ä»¶ï¼š
```
GEMINI_API_KEY=your_api_key_here
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```bash
npm run build
npm run preview
```

### Netlify éƒ¨ç½²

**NFC API è·¯ç”±**:
```
/api/nfc/wanxiang  â†’  Netlify Function  â†’  é‡å®šå‘åˆ° /?nfc=wanxiang&t=æ—¶é—´æˆ³
```

**æœ¬åœ°æµ‹è¯• Functions**:
```bash
# å®‰è£… Netlify CLI
npm install -g netlify-cli

# æœ¬åœ°è¿è¡Œï¼ˆåŒ…æ‹¬ Functionsï¼‰
netlify dev
```

**éƒ¨ç½²**:
- æ¨é€åˆ° main åˆ†æ”¯è‡ªåŠ¨éƒ¨ç½²
- PR è‡ªåŠ¨ç”Ÿæˆé¢„è§ˆé“¾æ¥

### éªŒè¯æ•°æ®åŸ‹ç‚¹
```sql
-- æŸ¥çœ‹æœ€è¿‘çš„ fragrance_confirm äº‹ä»¶
SELECT
  event_type,
  event_data->>'entryType' as entry_type,
  event_data->>'fragranceId' as fragrance_id,
  event_data->>'wasSwitched' as was_switched,
  created_at
FROM analytics_events
WHERE event_type = 'fragrance_confirm'
ORDER BY created_at DESC
LIMIT 10;
```

---

*å°å±¿å’Œ Â· å’Œè‡ªå·±ï¼Œå¥½å¥½åœ¨ä¸€èµ·*
